<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for Simple Fortran Project">
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>hru_control &ndash; Simple Fortran Project</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Simple Fortran Project </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/blockdata.html">Block Data</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>hru_control
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.5% of total for proc.">625 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/hru_control.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/hru_control.f90.html'>hru_control.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">hru_control</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

    <em>None</em>

  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine hru_control()  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/time_module.html'>time_module</a></li>
                  <li class="list-inline-item"><a href='../module/septic_data_module.html'>septic_data_module</a></li>
                  <li class="list-inline-item"><a href='../module/water_body_module.html'>water_body_module</a></li>
                  <li class="list-inline-item"><a href='../module/hru_module.html'>hru_module</a></li>
                  <li class="list-inline-item"><a href='../module/hydrograph_module.html'>hydrograph_module</a></li>
                  <li class="list-inline-item"><a href='../module/output_landscape_module.html'>output_landscape_module</a></li>
                  <li class="list-inline-item"><a href='../module/soil_module.html'>soil_module</a></li>
                  <li class="list-inline-item"><a href='../module/constituent_mass_module~2.html'>constituent_mass_module</a></li>
                  <li class="list-inline-item"><a href='../module/organic_mineral_mass_module.html'>organic_mineral_mass_module</a></li>
                  <li class="list-inline-item"><a href='../module/plant_module~2.html'>plant_module</a></li>
                  <li class="list-inline-item"><a href='../module/basin_module~2.html'>basin_module</a></li>
                  <li class="list-inline-item"><a href='../module/carbon_module.html'>carbon_module</a></li>
                  <li class="list-inline-item"><a href='../module/climate_module~2.html'>climate_module</a></li>
                  <li class="list-inline-item"><a href='../module/reservoir_data_module.html'>reservoir_data_module</a></li>
                  <li class="list-inline-item"><a href='../module/output_ls_pesticide_module.html'>output_ls_pesticide_module</a></li>
                  <li class="list-inline-item"><a href='../module/salt_module~2.html'>salt_module</a></li>
                  <li class="list-inline-item"><a href='../module/cs_module.html'>cs_module</a></li>
                  <li class="list-inline-item"><a href='../module/gwflow_module~2.html'>gwflow_module</a></li>
                  <li class="list-inline-item"><a href='../module/tillage_data_module~2.html'>tillage_data_module</a></li>
                  <li class="list-inline-item"><a href='../module/conditional_module.html'>conditional_module</a></li>
                  <li class="list-inline-item"><a href='../module/reservoir_module.html'>reservoir_module</a></li>
                  <li class="list-inline-item"><a href='../module/plant_data_module~2.html'>plant_data_module</a></li>
                  <li class="list-inline-item"><a href='../module/mgt_operations_module.html'>mgt_operations_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>


    <div class="codehilite"><pre><span></span><code>~ ~ ~ PURPOSE ~ ~ ~
this subroutine controls the simulation of the land phase of the 
hydrologic cycle
</code></pre></div>

<p>adjust precip and temperature for elevation using lapse rates
 zero pesticide balance variables
 zero all variables except pest in soil and in/on plant
ht1== deposition: write to deposition.out
ht2== outflow from inflow: added to hru generated flows
 check auto operations
 check day of future fertilizer application
 if end of year, reset the one time operation per year
 increment days since last plant and harvest
 update base zero total heat units
 zero stresses
 calculate albedo for day
 calculate soil temperature for soil layers
compute canopy interception
 compute snow melt
route overland flow across hru - add tile flow if not subirrigation or saturated buffer
route incoming surface runoff
 add surface runon to wetland
 route across hru - infiltrate and deposit sediment
add lateral flow soil water
Route incoming lateral soil flow
 add tile flow to tile (saturated buffer)
add aquifer flow to bottom soil layer and redistribute upwards
Route incoming aquifer flow
 compute crack volume
 compute evapotranspiration
 perform management operations
 compute surface runoff processes
 if wetland - no runoff or sediment yield - all constituents
 transported in surface runoff and sediment will be zero
 ht2%sed==sediment routed across hru from surface runon
 check wetland/paddy continuous irrigation Jaehak 2023
 manual irrigation on if ponding depth is lower than the threshold depth 
 wetland/paddy processes
 compute effective rainfall (amount that percs into soil)
 for wetland use seepage into soil from ponded water
 no wetland (no ponded water)
 add irrigation to subdaily effective precip
 perform soil water routing
 compute peak rate similar to swat-deg using SCS triangular unit hydrograph</p>
<p>graze only if adequate biomass in HRU
 if total above ground biomass is available - graze
 check to set if grazing period is over
 compute residue decomposition and nitrogen and phosphorus mineralization
 compute residue decomposition and nitrogen and phosphorus mineralization
 compute biozone processes in septic HRUs
 if 1) current is septic hru and 2) soil temperature is above zero
 compute plant community partitions
 check irrigation demand decision table for water allocation (after adding irrigation)
 iauto points to pcom(j)%dtbl(iauto) for days between operation
 check monsoon season for tropical plants
 compute plant biomass, leaf, root and seed growth
 reset harvested biomass and number of harvests for yearly yield output
 compute total parms for all plants in the community
 compute aoil water content to 300 mm depth
 compute actual ET for day in HRU
 compute pesticide washoff <br>
 compute pesticide uptake
 compute pesticide degradation
 compute pesticide movement in soil
 sum total pesticide in soil
 static carbon organic n in runoff
 C-Farm (Armen) c and organic n in runoff
 SWAT-C Xuesong -- c and organic n in runoff
 add nitrate in rainfall to soil profile
 compute nitrate movement leaching
 compute phosphorus movement
 compute pathogen transport
 compute loadings from urban areas
 compute sediment loading in lateral flow and add to sedyld
 lag nutrients and sediment in surface runoff
 lag subsurface flow and nitrate in subsurface flow
 compute reduction in pollutants due to edge-of-field filter strip
 compute reduction in pollutants due to in field grass waterway
 compute reduction in pollutants due to in fixed BMP eff
 ht2%flo is outflow from wetland or total saturation excess if no wetland
 mm = m3/ha <em>ha/10000m2 </em>1000mm/m
 calculate amount of surface runoff during day (qday) and store the remainder
 check if hru is a source for a saturated buffer
 use decision table
 set amount of tile flow to send to buffer hru
 convert to mm of the receiving hru and adjust for fraction of incoming hru
 compute water yield for HRU
 compute chl-a, CBOD and dissolved oxygen loadings
 add evap from impounded water (wetland) to et and esoil
 set hydrographs for direct routing or landscape unit</p>


    <h3>Arguments</h3>
    <em>None</em>
    <br>



    <section>
      <h3>I/O Operations</h3>
          <div class="accordion" id="ioAccordion">
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingunit_100100">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapseunit_100100" aria-expanded="true" 
                    aria-controls="collapseunit_100100">
              Unit unit_100100
            </button>
          </h3>
          <div id="collapseunit_100100" class="accordion-collapse collapse show" 
               aria-labelledby="headingunit_100100" data-bs-parent="#ioAccordion">
            <div class="accordion-body">
                <table class="table table-sm">
                  <thead>
                    <tr>
                      <th>Operation</th>
                      <th>Details</th>
                      <th>Condition</th>
                      <th>Line</th>
                    </tr>
                  </thead>
                  <tbody>
                      <tr>
                        <td><span class="badge bg-primary">write</span></td>
                        <td><code>write(100100,'(4(I6,","),20(f20.1,","))') time%yrc,time%mo,time%day_mo,j,w%precip,irrig(j)%applied,hru(j)%water_seep, pet_day,etday,wet_ob(j)%weir_hgt*1000,wet_ob(j)%depth*1000.,ht2%flo/(hru(j)%area_ha*10.),soil(j)%sw,sedppm,ht2%sed*1000, wet(j)%no3,ht2%no3,pcom(j)%lai_sum,saltcon</code></td>
                        <td>
                            <small class="text-info">if (wet_ob(j)%depth > 100.)</small>
                              <br><small class="text-muted">(line 538)</small>
                        </td>
                        <td>541</td>
                      </tr>
                  </tbody>
                </table>
            </div>
          </div>
        </div>
    </div>

    </section>
    <br>

    <br>


    
    

    
    



    
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Simple Fortran Project
              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>