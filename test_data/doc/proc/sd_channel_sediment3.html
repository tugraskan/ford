<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for Fortran Program">
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>sd_channel_sediment3 &ndash; Fortran Program</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../program/main.html">Program</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>sd_channel_sediment3
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.3% of total for proc.">178 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/sd_channel_sediment3.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/sd_channel_sediment3.f90.html'>sd_channel_sediment3.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">sd_channel_sediment3</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

    <em>None</em>

  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2> subroutine sd_channel_sediment3()  
</h2>
        <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/time_module.html'>time_module</a></li>
                  <li class="list-inline-item"><a href='../module/hydrograph_module.html'>hydrograph_module</a></li>
                  <li class="list-inline-item"><a href='../module/channel_module.html'>channel_module</a></li>
                  <li class="list-inline-item"><a href='../module/sd_channel_module.html'>sd_channel_module</a></li>
                  <li class="list-inline-item"><a href='../module/climate_module.html'>climate_module</a></li>
                  <li class="list-inline-item"><a href='../module/reservoir_module.html'>reservoir_module</a></li>
                  <li class="list-inline-item"><a href='../module/hru_module.html'>hru_module</a></li>
                  <li class="list-inline-item"><a href='../module/water_body_module.html'>water_body_module</a></li>
              </ul>
            </li>
        </ul>
      </div>
    </div>


    <p>calculate channel sed and nutrient processes if inflow &gt; 0
calculate peak daily flow
interpolate rating curve using peak rate
use peakrate as flow rate
add precip to inflow - km * m * 1000 m/km * ha/10000 m2 = ha
m3 = 10. * mm * ha
compute flood plain deposition
assume a triangular distribution
flow is over within the day
flow continues over the day - florate is the rate under the triangle
trap efficiency from Dynamic SedNet Component Model Reference Guide: Update 2017
deposit Particulate P and N in the floodplain
trap nitrate and sol P in flood plain - when not simulating flood plain interactions?
if flood plain link - fill wetlands to emergency
fill wetland storage to emergency volume
calculate overbank volume left to fill wetland
add sediment deposition to calculate mm of deposition over the flood plain later
calc bank erosion
calculate radius of curvature
bank erosion m/yr
write for Peter</p>
<p>mass of sediment eroded -&gt; t = 1000 * bankcut (mm) * depth (m) * lengthcut (m) * bd (t/m3)
arc length = 0.33 * meander wavelength * sinuosity </p>
<p>calculate associated nutrients
calculate channel deposition based on fall velocity - SWRRB book
assume particle size = 0.03 mm -- median silt size</p>
<p>assume bankfull flow depth</p>
<p>calculate channel deposition as the bedload fraction of bank erosion 
calculate bed erosion
no downcutting below equilibrium slope
calc critical shear and shear on bottom of channel
Pa = N/m^2 * m * m/m
critical shear function of d50
bed erosion m/yr
calc mass of sediment eroded -&gt; t = m * width (m) * length (km) * 1000 m/km * bd (t/m3)
calculate associated nutrients</p>


    <div class="card mb-3">
      <a data-bs-toggle="collapse" href="#arguments-section" 
         aria-expanded="true" 
         aria-controls="arguments-section" 
         class="text-decoration-none">
        <h3 class="card-header bg-light text-dark">
          <i class="fa fa-caret-down me-2"></i>Arguments
        </h3>
      </a>
      <div id="arguments-section" class="collapse show">
        <div class="card-body">
            <em>None</em>
        </div>
      </div>
    </div>


    <div class="card mb-3">
      <a data-bs-toggle="collapse" href="#local-variables-section" 
         aria-expanded="false" 
         aria-controls="local-variables-section" 
         class="text-decoration-none">
        <h3 class="card-header bg-light text-dark">
          <i class="fa fa-caret-down me-2"></i>Local Variables
        </h3>
      </a>
      <div id="local-variables-section" class="collapse">
        <div class="card-body">
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="var-iob"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iob</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ihru"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ihru</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-iihru"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iihru</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ires"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ires</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-rto"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rto</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-rto1"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rto1</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-trap_eff"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>trap_eff</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-cohesion"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cohesion</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-b_exp"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>b_exp</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-vel_fall"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel_fall</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-dep_fall"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>dep_fall</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-del_rto"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>del_rto</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ebtm_m"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ebtm_m</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ebank_m"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ebank_m</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ebtm_t"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ebtm_t</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ebank_t"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ebank_t</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-shear_btm_cr"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>shear_btm_cr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-shear_btm"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>shear_btm</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-inflo"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>inflo</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-inflo_rate"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>inflo_rate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-flo_time"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>flo_time</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-bf_flow"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bf_flow</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-pk_rto"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>pk_rto</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-bd_fac"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>bd_fac</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-cohes_fac"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>cohes_fac</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-florate"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>florate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-vel"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-veg"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>veg</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-vel_cr"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel_cr</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-rad_curv"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>rad_curv</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-vel_bend"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel_bend</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-vel_rch"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vel_rch</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-arc_len"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>arc_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-prot_len"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>prot_len</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-h_rad"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>h_rad</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-fp_m2"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>fp_m2</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-exp_co"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>exp_co</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-florate_ob"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>florate_ob</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-precip"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>precip</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-flovol_ob"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>flovol_ob</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-wet_fill"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>wet_fill</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="var-ave_rate"></span>
              real,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ave_rate</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </div>
      </div>
    </div>
    <br>

    <div class="card mb-3">
      <a data-bs-toggle="collapse" href="#outside-variables-section" 
         aria-expanded="false" 
         aria-controls="outside-variables-section" 
         class="text-decoration-none">
        <h3 class="card-header bg-light text-dark">
          <i class="fa fa-caret-down me-2"></i>Outside Variables and Types Used
        </h3>
      </a>
      <div id="outside-variables-section" class="collapse">
        <div class="card-body">
              
    <div class="accordion" id="outsideVarsAccordion">
        <div class="accordion-item">
          <h3 class="accordion-header" id="headinginteger">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapseinteger" aria-expanded="false" 
                    aria-controls="collapseinteger">
              integer
              <small class="text-muted ms-2">(6 attributes from hydrograph_module)</small>
            </button>
          </h3>
          <div id="collapseinteger" class="accordion-collapse collapse" 
               aria-labelledby="headinginteger" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>jrch</strong></td>
                      <td><p>none |reach number</p><a href="../module/hydrograph_module.html#variable-jrch~2" class="pull-right"><emph>Read more&hellip;</emph></a></td>
                    </tr>
                    <tr>
                      <td><strong>iwst</strong></td>
                      <td><p>| </p></td>
                    </tr>
                    <tr>
                      <td><strong>isdch</strong></td>
                      <td><p>|</p></td>
                    </tr>
                    <tr>
                      <td><strong>icmd</strong></td>
                      <td><p>|</p></td>
                    </tr>
                    <tr>
                      <td><strong>ich</strong></td>
                      <td><p>none |object number </p><a href="../module/hydrograph_module.html#variable-ich~3" class="pull-right"><emph>Read more&hellip;</emph></a></td>
                    </tr>
                    <tr>
                      <td><strong>ihru</strong></td>
                      <td><p>none |HRU number</p><a href="../module/hru_module.html#variable-ihru~24" class="pull-right"><emph>Read more&hellip;</emph></a></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_hyd_output_html__hyd_output__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_hyd_output_html__hyd_output__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_hyd_output_html__hyd_output__a__">
              type(<a href='../type/hyd_output.html'>hyd_output</a>)
              <small class="text-muted ms-2">(4 attributes from hydrograph_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_hyd_output_html__hyd_output__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_hyd_output_html__hyd_output__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>hz</strong></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td><strong>ch_trans</strong></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td><strong>wet</strong></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td><strong>wet_in_d</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype" aria-expanded="false" 
                    aria-controls="collapsetype">
              type
              <small class="text-muted ms-2">(30 attributes from hydrograph_module)</small>
            </button>
          </h3>
          <div id="collapsetype" class="accordion-collapse collapse" 
               aria-labelledby="headingtype" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>ht1%sedp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ht1%orgn</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ht1%sed</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ht1%flo</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>fp_dep%sedp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>fp_dep%no3</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>fp_dep%orgn</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>fp_dep%solp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>fp_dep%sed</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ch_dep%sedp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ch_dep%orgn</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>ch_dep%sed</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%no2</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%sedp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%no3</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%orgn</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%solp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%sed</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bank_ero%flo</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%no2</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%sedp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%no3</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%orgn</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%solp</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%sed</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>bed_ero%flo</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>sp_ob1%chandeg</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>rcurv%xsec_area</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>rcurv%wet_perim</strong></td>
                      <td>None</td>
                    </tr>
                    <tr>
                      <td><strong>rcurv%dep</strong></td>
                      <td>None</td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_object_connectivity_html__object_connectivity__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_object_connectivity_html__object_connectivity__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_object_connectivity_html__object_connectivity__a__">
              type(<a href='../type/object_connectivity.html'>object_connectivity</a>)
              <small class="text-muted ms-2">(1 attribute from hydrograph_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_object_connectivity_html__object_connectivity__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_object_connectivity_html__object_connectivity__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>ob</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingreal">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsereal" aria-expanded="false" 
                    aria-controls="collapsereal">
              real
              <small class="text-muted ms-2">(2 attributes from channel_module)</small>
            </button>
          </h3>
          <div id="collapsereal" class="accordion-collapse collapse" 
               aria-labelledby="headingreal" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>rttime</strong></td>
                      <td><p>hr |reach travel time</p><a href="../module/channel_module.html#variable-rttime" class="pull-right"><emph>Read more&hellip;</emph></a></td>
                    </tr>
                    <tr>
                      <td><strong>peakrate</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_channel_morphology_output_html__channel_morphology_output__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_morphology_output_html__channel_morphology_output__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_morphology_output_html__channel_morphology_output__a__">
              type(<a href='../type/channel_morphology_output.html'>channel_morphology_output</a>)
              <small class="text-muted ms-2">(1 attribute from sd_channel_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_morphology_output_html__channel_morphology_output__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_channel_morphology_output_html__channel_morphology_output__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>ch_morph</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_swatdeg_channel_dynamic_html__swatdeg_channel_dynamic__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_swatdeg_channel_dynamic_html__swatdeg_channel_dynamic__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_swatdeg_channel_dynamic_html__swatdeg_channel_dynamic__a__">
              type(<a href='../type/swatdeg_channel_dynamic.html'>swatdeg_channel_dynamic</a>)
              <small class="text-muted ms-2">(1 attribute from sd_channel_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_swatdeg_channel_dynamic_html__swatdeg_channel_dynamic__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_swatdeg_channel_dynamic_html__swatdeg_channel_dynamic__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>sd_ch</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_channel_rating_curve_html__channel_rating_curve__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_rating_curve_html__channel_rating_curve__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_rating_curve_html__channel_rating_curve__a__">
              type(<a href='../type/channel_rating_curve.html'>channel_rating_curve</a>)
              <small class="text-muted ms-2">(1 attribute from sd_channel_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_channel_rating_curve_html__channel_rating_curve__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_channel_rating_curve_html__channel_rating_curve__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>ch_rcurv</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_weather_station_html__weather_station__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_weather_station_html__weather_station__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_weather_station_html__weather_station__a__">
              type(<a href='../type/weather_station.html'>weather_station</a>)
              <small class="text-muted ms-2">(1 attribute from climate_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_weather_station_html__weather_station__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_weather_station_html__weather_station__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>wst</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_wetland_html__wetland__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_wetland_html__wetland__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_wetland_html__wetland__a__">
              type(<a href='../type/wetland.html'>wetland</a>)
              <small class="text-muted ms-2">(1 attribute from reservoir_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_wetland_html__wetland__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_wetland_html__wetland__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>wet_ob</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_hydrologic_response_unit_html__hydrologic_response_unit__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_hydrologic_response_unit_html__hydrologic_response_unit__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_hydrologic_response_unit_html__hydrologic_response_unit__a__">
              type(<a href='../type/hydrologic_response_unit.html'>hydrologic_response_unit</a>)
              <small class="text-muted ms-2">(1 attribute from hru_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_hydrologic_response_unit_html__hydrologic_response_unit__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_hydrologic_response_unit_html__hydrologic_response_unit__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>hru</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="headingtype__a_href___workspaces_ford_test_data_doc_type_water_body_html__water_body__a__">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#collapsetype__a_href___workspaces_ford_test_data_doc_type_water_body_html__water_body__a__" aria-expanded="false" 
                    aria-controls="collapsetype__a_href___workspaces_ford_test_data_doc_type_water_body_html__water_body__a__">
              type(<a href='../type/water_body.html'>water_body</a>)
              <small class="text-muted ms-2">(1 attribute from water_body_module)</small>
            </button>
          </h3>
          <div id="collapsetype__a_href___workspaces_ford_test_data_doc_type_water_body_html__water_body__a__" class="accordion-collapse collapse" 
               aria-labelledby="headingtype__a_href___workspaces_ford_test_data_doc_type_water_body_html__water_body__a__" data-bs-parent="#outsideVarsAccordion">
            <div class="accordion-body">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th scope="col">Attribute Name</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                    <tr>
                      <td><strong>ch_wat_d</strong></td>
                      <td></td>
                    </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
    </div>

        </div>
      </div>
    </div>
    <br>


    <br>

    <br>

    <div class="card mb-3">
      <a data-bs-toggle="collapse" href="#logic-blocks-section" 
         aria-expanded="false" 
         aria-controls="logic-blocks-section" 
         class="text-decoration-none">
        <h3 class="card-header bg-light text-dark">
          <i class="fa fa-caret-down me-2"></i>Logic Blocks
        </h3>
      </a>
      <div id="logic-blocks-section" class="collapse">
        <div class="card-body">
          <p class="text-muted mb-3">
            Control flow structures organized as they appear in the source code. 
            Each block is collapsible to help navigate complex procedures.
          </p>
          
                        
                <div class="card mb-2 ms-0">
                  <div class="card-body">
                    <pre class="mb-0"><code>use climate_module
use sd_channel_module
use channel_module
use hydrograph_module
use time_module
use hru_module, only : hru
use water_body_module
use reservoir_module
implicit none
integer :: iob = 0            !               |object number
integer :: ihru = 0
integer :: iihru = 0
integer :: ires = 0
real :: rto = 0.
real :: rto1 = 0.
real :: trap_eff = 0.         !frac           |trap efficiency in the flood plain
real :: cohesion = 0.         !               |soil bank cohesion
real :: b_exp = 0.            !               |exponent for bank erosion equation
real :: vel_fall = 0.         !m/s            |fall velocity of sediment particles in channel
real :: dep_fall = 0.         !m              |fall depth of sediment particles in channel
real :: del_rto = 0.          !frac           |fraction of sediment deposited in channel
real :: ebtm_m = 0.           !m              |erosion of bottom of channel
real :: ebank_m = 0.          !m              |meander cut on one side
real :: ebtm_t = 0.           !tons           |bottom erosion
real :: ebank_t = 0.          !tons           |bank erosion
real :: shear_btm_cr = 0.     !               |
real :: shear_btm = 0.        !               |
real :: inflo = 0.                 !m^3            |inflow water volume
real :: inflo_rate = 0.            !m^3/s          |inflow rate
real :: flo_time = 0.              !s              |estimate of total flow time through the channel
real :: bf_flow = 0.          !m3/s           |bankfull flow rate * adjustment factor
real :: pk_rto = 0.           !ratio          |peak to mean flow rate ratio
real :: bd_fac = 0.           !               |bulk density factor for critical velocity calculation
real :: cohes_fac = 0.        !               |cohesion factor for critical velocity calculation
real :: florate               !m^3/s          |flow rate below the triangle for flow lasting more than a day
real :: vel = 0.
real :: veg = 0.
real :: vel_cr = 0.
real :: rad_curv = 0.
real :: vel_bend = 0.
real :: vel_rch = 0.
real :: arc_len = 0.
real :: prot_len = 0.
real :: h_rad = 0.
real :: fp_m2 = 0.
real :: exp_co = 0.
real :: florate_ob = 0.
real :: precip = 0.
real :: flovol_ob = 0.
real :: wet_fill = 0.
real :: ave_rate
ich = isdch
iob = sp_ob1%chandeg + jrch - 1
ebtm_m = 0.
ebank_m = 0.
ebtm_t = 0.
ebank_t = 0.
fp_dep = hz
ch_dep = hz
bank_ero = hz
bed_ero = hz
ch_trans = hz
ch_wat_d(ich)%precip = 0.</code></pre>
                  </div>
                </div>

                        
              <div class="card mb-2 ms-0">
                <a data-bs-toggle="collapse" href="#block-2" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>ht1%flo > 1.e-6</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>pk_rto = sd_ch(ich)%pk_rto * (1. + 2.66 * (ob(icmd)%area_ha / 100.) ** (-.3))
peakrate = pk_rto * ht1%flo / 86400.     !m3/s
call rcurv_interp_flo (ich, peakrate)
h_rad = rcurv%xsec_area / rcurv%wet_perim
vel = h_rad ** .6666 * Sqrt(sd_ch(ich)%chs) / (sd_ch(ich)%chn + .001)
vel = peakrate / rcurv%xsec_area
rttime = sd_ch(ich)%chl / (3.6 * vel)
ch_wat_d(ich)%area_ha = sd_ch(ich)%chl * sd_ch(ich)%chw / 10.
precip = 10. * wst(iwst)%weat%precip * ch_wat_d(ich)%area_ha
ch_wat_d(ich)%precip = precip
rto = precip / ht1%flo
ob(icmd)%tsin(:) = (1. + rto) * ob(icmd)%tsin(:)
ht1%flo = ht1%flo + precip
ave_rate = ht1%flo / 86400.     !m3/s
bf_flow = sd_ch(ich)%bankfull_flo * ch_rcurv(ich)%elev(2)%flo_rate
florate_ob = ave_rate - bf_flow</code></pre>
                                  
              <div class="card mb-2 ms-3">
                <a data-bs-toggle="collapse" href="#block-2-block-1" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>florate_ob > 0.</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>flo_time = 2. * ht1%flo / ave_rate
flovol_ob = Min (0.8 * ht1%flo, flovol_ob)
fp_m2 = 3. * sd_ch(ich)%chw * sd_ch(ich)%chl * 1000.
exp_co = 0.0003 * fp_m2 / florate_ob
trap_eff = sd_ch(ich)%fp_inun_days * (florate_ob / ave_rate) * (1. - exp(-exp_co))
trap_eff = Min (1., trap_eff)
fp_dep%sed = trap_eff * ht1%sed
fp_dep%orgn = trap_eff * sd_ch(ich)%n_dep_enr * ht1%orgn
fp_dep%sedp = trap_eff * sd_ch(ich)%p_dep_enr * ht1%sedp
fp_dep%no3 = 0.         !trap_eff * ht1%no3
fp_dep%solp = 0.        !trap_eff * ht1%solp
ht1 = ht1 - fp_dep
end if     ! florate_ob > 0.
ch_morph(ich)%fp_mm = ch_morph(ich)%fp_mm + fp_dep%sed
cohesion = (-87.1 + (42.82 * sd_ch(ich)%ch_clay) - (0.261 * sd_ch(ich)%ch_clay ** 2.) &
+ (0.029 * sd_ch(ich)%ch_clay ** 3.))
cohesion = amax1 (1000., cohesion)    !min 1000 for sandy soils
veg = exp (-5. * sd_ch(ich)%chd) * 4500. * sd_ch(ich)%cov
bd_fac = Max (0.001, 0.03924 * sd_ch(ich)%ch_bd * 1000. - 1000.)
cohes_fac = 0.021 * cohesion + veg
vel_cr = log10 (2200. * sd_ch(ich)%chd) * (0.0004 * (bd_fac + cohes_fac)) ** 0.5
vel_cr = sd_ch(ich)%vcr_coef * vel_cr
rad_curv = ((12. * sd_ch(ich)%chw) * sd_ch(ich)%sinu ** 1.5) /               &
(13. * (sd_ch(ich)%sinu -1.) ** 0.5)
vel_bend = vel * (1. / rad_curv + 1.)
vel_rch = 0.33 * vel_bend + 0.66 * vel
b_exp = 12.3 / sqrt (sd_ch(ich)%ch_clay + 1.)
b_exp = min (3.5, b_exp)
ch_morph(ich)%w_yr = ch_morph(ich)%w_yr + ebank_m
arc_len = 0.25 * sd_ch(ich)%chl
prot_len = arc_len * sd_ch(ich)%arc_len_fr
ebank_t = 1000. * ebank_m * sd_ch(ich)%chd * arc_len * sd_ch(ich)%ch_bd
bank_ero%sed = ebank_t
bank_ero%orgn = bank_ero%sed * sd_ch(ich)%n_conc / 1000.
bank_ero%sedp = (1. - sd_ch(ich)%p_bio) * bank_ero%sed * sd_ch(ich)%p_conc / 1000.
bank_ero%no3 = 0.
bank_ero%solp = sd_ch(ich)%p_bio * bank_ero%sed * sd_ch(ich)%p_conc / 1000.
bank_ero%no2 = 0.
rto = bank_ero%flo / ht1%flo
ob(icmd)%tsin(:) = (1. - rto) * ob(icmd)%tsin(:)
ht1 = ht1 + bank_ero
ch_dep%sed = sd_ch(ich)%wash_bed_fr * bank_ero%sed
ch_dep%orgn = sd_ch(ich)%n_dep_enr * sd_ch(ich)%wash_bed_fr * bank_ero%orgn
ch_dep%sedp = sd_ch(ich)%p_dep_enr * sd_ch(ich)%wash_bed_fr * bank_ero%sedp
ht1 = ht1 - ch_dep
ch_morph(ich)%d_yr = ch_morph(ich)%d_yr + ebtm_m
bed_ero%sed = sd_ch(ich)%wash_bed_fr * ebtm_t
bed_ero%orgn = bed_ero%sed * sd_ch(ich)%n_conc
bed_ero%sedp = (1. - sd_ch(ich)%p_bio) * bed_ero%sed * sd_ch(ich)%p_conc
bed_ero%no3 = 0.
bed_ero%solp = sd_ch(ich)%p_bio * bed_ero%sed * sd_ch(ich)%p_conc
bed_ero%no2 = 0.
rto = bed_ero%flo / ht1%flo
end if        ! inflow>0
return</code></pre>
                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-1" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>flo_time < 86400.</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-1" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>flovol_ob = ht1%flo * (((ave_rate - bf_flow) / ave_rate) ** 2)</code></pre>
                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-2" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>ELSE</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-2" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>florate = 2. * ht1%flo - ave_rate
flovol_ob = ht1%flo * (((ave_rate - bf_flow) / (ave_rate - florate)) ** 2)</code></pre>
                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-3" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-warning bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>DO</strong> <code>ihru = 1, sd_ch(ich)%fp%hru_tot</code>
                  </div>
                </a>
                <div id="block-2-block-1-block-3" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>iihru = sd_ch(ich)%fp%hru(ihru)
ires= hru(iihru)%dbs%surf_stor
wet_fill = wet_ob(iihru)%evol - wet(iihru)%flo
flovol_ob = flovol_ob - wet_fill</code></pre>
                                  
              <div class="card mb-2 ms-9">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-3-block-1" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>flovol_ob < 0.</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-3-block-1" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>wet_fill = wet_fill + flovol_ob
flovol_ob = 0.</code></pre>
                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-9">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-3-block-2" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>ires > 0 .and. wet_fill > 0.</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-3-block-2" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>rto = wet_fill / ht1%flo
rto = Min (1., rto)</code></pre>
                                  
              <div class="card mb-2 ms-12">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-3-block-2-block-1" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>rto > 1.e-6</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-3-block-2-block-1" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>wet(iihru) = wet(iihru) + rto * ht1
wet_in_d(iihru) = wet_in_d(iihru) + rto * ht1
hru(iihru)%wet_obank_in = (rto * ht1%flo) / (10. * hru(iihru)%area_ha)
rto1 = 1. - rto
ob(icmd)%tsin(:) = rto1 * ob(icmd)%tsin(:)
ht1 = rto1 * ht1</code></pre>
                  </div>
                </div>
              </div>

                  </div>
                </div>
              </div>

                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-4" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>vel_rch > vel_cr</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-4" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>ebank_m = 0.00024 * (vel_rch / vel_cr) ** sd_ch(ich)%bank_exp</code></pre>
                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-5" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>ELSE</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-5" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>ebank_m = 0.</code></pre>
                  </div>
                </div>
              </div>

                                  
              <div class="card mb-2 ms-6">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-6" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>sd_ch(ich)%chs > 0.000001</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-6" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>shear_btm_cr = sd_ch(ich)%d50
shear_btm = 9800. * rcurv%dep * sd_ch(ich)%chs   !! Pa = N/m^2 * m * m/m
vel_cr = 0.293 * (sd_ch(ich)%d50) ** 0.5
ebtm_t = 1000. * ebtm_m * sd_ch(ich)%chw * sd_ch(ich)%chl * sd_ch(ich)%ch_bd</code></pre>
                                  
              <div class="card mb-2 ms-9">
                <a data-bs-toggle="collapse" href="#block-2-block-1-block-6-block-1" 
                   aria-expanded="false" 
                   class="text-decoration-none">
                  <div class="card-header bg-info bg-opacity-10">
                    <i class="fa fa-caret-right me-2"></i>
                    <strong>IF</strong> (<code>vel > vel_cr</code>) <strong>THEN</strong>
                  </div>
                </a>
                <div id="block-2-block-1-block-6-block-1" class="collapse">
                  <div class="card-body">
                      <pre class="mb-0"><code>ebtm_m = 0.0001 * (vel_rch / vel_cr) ** sd_ch(ich)%bed_exp</code></pre>
                  </div>
                </div>
              </div>

                  </div>
                </div>
              </div>

                  </div>
                </div>
              </div>

                  </div>
                </div>
              </div>

        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Fortran Program
              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>